/* author: Timur Valiyev | email: v.timur8484@gmail.com | website: www.web-pro84.ru */

!function(e){return e(function(){var n,t,r,a,o,s,i,d,u,l,c,m,f,p,v,h;return r=e(document),t=e(".js-background"),o=e(".js-dropdown-item"),s=e(".js-dropdown-link"),d=e(".js-fancybox-link"),u=!1,i=/^([a-z0-9_\.-])+@[a-z0-9-]+\.([a-z]{2,4}\.)?[a-z]{2,4}$/i,c=null,n=function(n){return e.each(n,function(n,t){var r,a;return a=e(t),r=a.attr("bg-url"),r?(r="url("+r+")",a.css("background-image",r)):void 0})},p=function(n){var t,r,a;return n.preventDefault(),n.stopPropagation(),a=e(this),r=a.parent(".js-dropdown-item"),r.hasClass("collapse-nav-item-dropped")?m():(m(),t=r.find(".js-dropdown"),t.addClass("dropdown-nav-menu-show"),r.addClass("collapse-nav-item-dropped"))},m=function(){var n;return n=e(".js-dropdown"),o.removeClass("collapse-nav-item-dropped"),n.removeClass("dropdown-nav-menu-show")},a=function(e){return m()},v=function(n){var t;return t=!0,e.each(n,function(n,r){var a,o,s;return a=e(r),s=a.attr("validate"),o=function(){switch(s){case"text":return a.val().length>3;case"email":return i.test(a.val());default:return!0}}(),o?void 0:(t=!1,a.addClass("form-input-haserror"))}),t},f=function(e,n){return setTimeout(n,1e3*e)},l=function(n){var t,r,a,o,s,i;return n.preventDefault(),!u&&(i=e(this),null!=c&&clearTimeout(c),r=i.find("*[validate]"),s=i.find(".js-submitbtn"),a=i.find(".js-ajaximg"),o=i.find(".js-form-message"),o.addClass("hidden"),v(r))?(u=!0,t=s.html(),s.html(a.html()),e.ajax({url:i.attr("action"),type:i.attr("method"),data:i.serialize(),dataType:"json",error:function(e,n,t){return console.log(t),o.text("При отправке произошла ошибка! Пожалуйста, попробуйте еще раз.")},success:function(e,n,t){return console.log(e),o.text(String(e.message)),i.trigger("reset")},complete:function(e,n){return o.removeClass("hidden"),u=!1,s.html(t),c=f(4,function(){return o.addClass("hidden")})}})):void 0},h=function(n){var t;return t=e(this),t.removeClass("form-input-haserror"),t.hasClass("js-maskphone")?t.mask("+7-999-999-99-99"):void 0},n(t),s.bind("click",p),r.bind("click",a),r.delegate(".js-form","submit",l),r.delegate(".js-form *[validate]","focusin",h),d.fancybox({padding:0,arrows:!1,nextClick:!0,maxWidth:"100%",fitToView:!1,scrolling:!1,helpers:{overlay:{locked:!0}}})})}(jQuery);
//# sourceMappingURL=base.min.js.map
